//==============================================================================================
//
// 体力ゲージ　　　hpgage.cpp
// 土田凌聖
//
//==============================================================================================

//**********************************************************************************************
// インクルード
//**********************************************************************************************
#include"hpgage.h"

//==============================================================================================
// コンストラクタ
//==============================================================================================
CHpGage::CHpGage() : CObject2D(3)
{
	m_fTotal = 0.0f;		// 体力
	m_fHpWidth = 0.0f;		// 体力ゲージの長さ
	m_fSubHp = 0.0f;		// 体力の減少量
	m_bZeroHp = false;		// 体力ゲージが０になったか
}

//==============================================================================================
// デストラクタ
//==============================================================================================
CHpGage::~CHpGage()
{

}

//==============================================================================================
// 初期化処理
//==============================================================================================
HRESULT CHpGage::Init(D3DXVECTOR3 pos)
{
	CObject2D::Init(pos);
	m_Pos = pos;
	m_fHpWidth = HP_WIDTH;	// 体力ゲージの長さ
	m_fTotal = HP;		// 体力

	return S_OK;
}

//==============================================================================================
// 終了処理
//==============================================================================================
void CHpGage::Uninit()
{
	CObject2D::Uninit();
}

//==============================================================================================
// 更新処理
//==============================================================================================
void CHpGage::Update()
{
	CObject2D::Update();

	if (m_bZeroHp)
	{
		Uninit();
	}
}

//==============================================================================================
// 描画処理
//==============================================================================================
void CHpGage::Draw()
{
	CObject2D::Draw();
}

//==============================================================================================
// 生成処理
//==============================================================================================
CHpGage *CHpGage::Create(D3DXVECTOR3 pos, float width, float width2, float height, D3DXCOLOR col)
{
	CHpGage *pHpgage = nullptr;

	pHpgage = new CHpGage;

	if (pHpgage != nullptr)
	{
		pHpgage->Init(pos);				// 初期化
		pHpgage->SetGagelength(width, width2, height);	// サイズの設定
		pHpgage->SetCol(col);							// 色の設定
	}

	return pHpgage;
}

//==============================================================================================
// 体力ゲージを減らす
//==============================================================================================
void CHpGage::SubHpgage(float Damage)
{
	// 体力の減少量の算出
	m_fSubHp = (m_fHpWidth * 2) * (Damage / 100);
	
	m_fTotal -= m_fSubHp;

	// 体力ゲージを減らす
	CObject2D::SetGageSize(m_fTotal);

	if (m_fTotal <= 0)
	{
		m_bZeroHp = true;
	}
}

//==============================================================================================
// 体力ゲージを増やす
//==============================================================================================
void CHpGage::AddHpgage(float Heal)
{
	// 体力の増加量の算出
	float m_fAddHp = (m_fHpWidth * 2) * (Heal / 100);
	m_fTotal += m_fAddHp;

	// 最大値を超えないようにする
	if (m_fTotal > HP)
	{
		m_fTotal = HP;
	}

	// 体力ゲージを増やす
	CObject2D::SetGageSize(m_fTotal);
}

//==============================================================================================
// 体力ゲージの位置
//==============================================================================================
void CHpGage::SetPos(D3DXVECTOR3 pos)
{
	CObject2D::Setposition(pos);
}

//==============================================================================================
// 体力ゲージの色の設定
//==============================================================================================
void CHpGage::SetCol(D3DXCOLOR col)
{
	CObject2D::SetCol(col);
}